\documentclass[letter,10pt]{article}

\usepackage{tikz,pgflibraryshapes}
\usetikzlibrary{arrows, calc, decorations.pathmorphing}
\usepackage[psfixbb,graphics,tightpage,active]{preview}

\PreviewEnvironment{tikzpicture}
\newlength{\imagewidth}
\newlength{\imagescale}

\usepackage{xcolor}
\usepackage{color}
\usepackage{amsmath}


\definecolor{orange}{RGB}{255,127,0}
\definecolor{gris}{RGB}{230,230,230}

\usetikzlibrary{shapes,arrows}
\pgfdeclarelayer{background}
\pgfdeclarelayer{foreground}
\pgfsetlayers{background,main,foreground}
\tikzstyle{startstop} = [rectangle, rounded corners, minimum width=3cm, minimum height=1.5cm,text centered, draw=black, fill=white!30,double]

\tikzstyle{circulo} = [circle, rounded corners, minimum width=1cm, minimum height=1cm,text centered, draw=black, fill=white!30,sloped]

\tikzstyle{pattern} = [rectangle, rounded corners, minimum height=0.6cm,text centered, draw=black, fill=white!30,text width=2cm]

\tikzstyle{pat} = [rectangle, rounded corners, minimum height=0.6cm,text centered, draw=black, fill=white!30,text width=2cm,double]

\tikzstyle{objseg} = [rectangle, rounded corners, minimum height=0.6cm,text centered, draw=black, fill=white!30,text width=2.5cm]

\tikzstyle{amenazas} = [rectangle, rounded corners, minimum height=0.6cm,text centered, draw=black, fill=white!30,text width=2cm]

\tikzstyle{arrow} = [thick,->,>=stealth]
\tikzstyle{arrow1} = [thick,<-,>=stealth]

\begin{document}

\begin{tikzpicture}[node distance=1.5cm]
	
	
	\node (req1) [circulo,xshift=3cm,yshift=2cm] {$Req_1$};
	
		
	\node (Int) [objseg,xshift=4.1cm] {Integridad};
	\node (Conf) [objseg,xshift=11.2cm] {Confidencialidad};
	\node (Dis) [objseg,xshift=18.3cm] {Disponibilidad};
	
	\draw [arrow] (req1) -- (Int);
	
	\node (w1) [draw=none,fill=none,xshift=4.1cm,yshift=-2cm] {$w_I$};
	\node (w2) [draw=none,fill=none,xshift=11.2cm,yshift=-2cm] {$w_C$};
	\node (w3) [draw=none,fill=none,xshift=18.3cm,yshift=-2cm] {$w_D$};
	
	\draw [thick] (Int) -- (w1);
	\draw [thick] (Conf) -- (w2);
	\draw [thick] (Dis) -- (w3);
	
	\node (ame1) [amenazas,yshift=-4cm,xshift=1.3cm] {Suplantaci\'on};
	\node (ame2) [amenazas,yshift=-4cm,xshift=4.1cm] {Repudio};
	\node (ame3) [amenazas,yshift=-4cm, xshift=6.8cm] {Informaci\'on expuesta};
	
	\node (ame4) [amenazas,yshift=-4cm,xshift=10.2cm] {Modificaci\'on};
	\node (ame5) [amenazas,yshift=-4cm,xshift=14.2cm] {Elevaci\'on de privilegios};
	\node (ame6) [amenazas,yshift=-4cm,xshift=18.3cm] {Denegaci\'on de servicios};
	
	\draw [arrow1] (w1) -- (ame1);
	\draw [arrow1] (w1) -- (ame2);
	\draw [arrow1] (w1) -- (ame3);
	\draw [arrow1] (w2) -- (ame4);
	\draw [arrow1] (w2) -- (ame5);
	\draw [arrow1] (w3) -- (ame6);
	
	\node (att1) [pattern,yshift=-6cm] {Phishing};
	\node (att2) [pattern,yshift=-7.5cm,xshift=1.3cm] {Identity theft};
	\node (att3) [pattern,yshift=-6cm,xshift=2.6cm] {Botnets};
	
	\draw [arrow] (ame1) -- (att1);
	\draw [arrow] (ame1) -- (att2);
	\draw [arrow] (ame1) -- (att3);
	
	%\node (att4) [pattern,yshift=-7cm,xshift=7.8cm] {Web application attacks};
	%\node (att5) [pattern,yshift=-8.5cm,xshift=6.8cm] {Information leakage};
	
	%\draw [arrow] (ame3) -- (att4);
	%\draw [arrow] (ame3) -- (att5);
	
	\node (att6) [pattern,yshift=-6cm,xshift=10.2cm] {Data breaches};
	
	\draw [arrow] (ame4) -- (att6);
	
	\node (att7) [pattern,yshift=-6cm,xshift=13cm] {Exploit kits};
	\node (att8) [pattern,yshift=-7.5cm,xshift=14.3cm] {Web based attacks};
	
	\draw [arrow] (ame5) -- (att7);
	\draw [arrow] (ame5) -- (att8);
	
	\node (att9) [pattern,yshift=-6cm,xshift=17cm] {DDoS};
	\node (att10) [pattern,yshift=-6cm,xshift=20cm] {Ransomware};
	
	\draw [arrow] (ame6) -- (att9);
	\draw [arrow] (ame6) -- (att10);
	
	\node (att11) [pattern,yshift=-6cm,xshift=5cm] {Diccionario};
	\node (att12) [pattern,yshift=-7.5cm,xshift=6.5cm] {Keylogger};
	\node (att13) [pattern,yshift=-6cm,xshift=7.9cm] {Fuerza Bruta};
	
	\draw [arrow] (ame3) -- (att11);
	\draw [arrow] (ame3) -- (att12);
	\draw [arrow] (ame3) -- (att13);
	
	\node (pat2) [pat,yshift=-10cm,xshift=6.6cm] {Patr\'on Contrase\~na};
	\draw [dotted,thick] (pat2) -| (att11);
	\draw [dotted,thick] (pat2) -| (att13);

	
\node (vacio1)  [draw=none,fill=none,yshift=-3.7cm,xshift=-0.7cm]{};
\node (vacio2)  [draw=none,fill=none,yshift=-7.5cm,xshift=20.7cm]{};
	\begin{pgfonlayer}{background}
		\path (ame1.west |- ame1.north)+(-0.5,0.3) node (a) {};
		\path (ame6.east |- ame6.south)+(+0.5,-0.5) node (c) {};
            	\path[fill=gris!20,rounded corners, draw=black,double] (a) rectangle (c);  
    	\end{pgfonlayer}

\end{tikzpicture}



\end{document}n